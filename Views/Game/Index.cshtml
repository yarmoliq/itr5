@{
    ViewData["Title"] = "Game";
}
@model itr5.Models.PlayerModel

<style>
    td {
    border: 1px solid black;
    height: 200px;
    width: 200px;
    }
</style>

<table id="tictactoe-table">
    <tr>
        <td id="cell_1"></td>
        <td id="cell_2"></td>
        <td id="cell_3"></td>
    </tr>
    <tr>
        <td id="cell_4"></td>
        <td id="cell_5"></td>
        <td id="cell_6"></td>
    </tr>
    <tr>
        <td id="cell_7"></td>
        <td id="cell_8"></td>
        <td id="cell_9"></td>
    </tr>
</table>

<button onclick="printOC()">check connection</button>

<script src="~/js/signalr/dist/browser/signalr.js"></script>
<script src="~/js/getUrlParams.js"></script>

<script>

    let connection = new signalR.HubConnectionBuilder().withUrl("/gamehub").build();
    var connectTo = '@Model.Id';

    connection.start().catch(err=>{
        alert("couldnt connect");
    })
    .then( function()
    {
        connection.invoke("GetConnectionId").then((data)=>{
            console.log("MY ID: " + data);
            console.log("OPP ID: " + '@Model.Id');
        });

        if(connectTo === ""){
            alert("creating new game");
            connection.invoke("NewGame");
        }
        else{
            alert("Will connect to: " + connectTo);
        }

    });

    connection.on("AssignOpponent", (ocid)=>{
        console.log("Opponent assigned = " + ocid);
        opponentConnectionId = ocid;
    });

    let printOC = function(){
        console.log("PRINTING OPPONENTS CONNECTION ID: " + opponentConnectionId);
    };

        
    //connection.on("Redirect",(controller, view)=>{
    //    window.location.href = "/"+controller+"/" + view;
    //});    
</script>